//Scronpt 0.2|regseb.github.io/scronpt
(function(l,h){"function"===typeof define&&define.amd?define([],h):"object"===typeof exports?module.exports=h():l.Cron=h()})(this,function(){var l=[[],[],[]," jan feb mar apr may jun jul aug sep oct nov dec".split(" "),"sun mon tue wed thu fri sat".split(" ")],h=/^(?:\*)(?:\/(\d+))?$/,n=/^(\d+)(?:-(\d+)(?:\/(\d+))?)?$/,k=[{min:0,max:59},{min:0,max:23},{min:1,max:31},{min:1,max:12},{min:0,max:7}],c=[],m=null,p=function(b){switch(b){case "@yearly":case "@annually":b="0 0 1 1 *";break;case "@monthly":b= "0 0 1 * *";break;case "@weekly":b="0 0 * * 0";break;case "@daily":case "@midnight":b="0 0 * * *";break;case "@hourly":b="0 * * * *"}var a=b.toLowerCase().split(/\s+/);if(5!==a.length)throw Error("Syntax error, unrecognized expression: "+b);var e=[];a.forEach(function(a,d){var c,f;if(-1!==(c=l[d].indexOf(a)))e.push([{min:c,max:c,step:1}]);else if(null!==(f=h.exec(a)))void 0===f[1]?e.push(null):e.push([{min:0,max:Infinity,step:parseInt(f[1],10)}]);else{var g=[];a.split(",").forEach(function(a){if(null!== (f=n.exec(a))){a=parseInt(f[1],10);var e=parseInt(f[2],10),c=parseInt(f[3],10);if(a<k[d].min||k[d].max<a||e<k[d].min||k[d].max<e||e<a)throw Error("Syntax error, unrecognized expression: "+b);g.push({min:a,max:isNaN(e)?a:e,step:isNaN(c)?1:c})}else throw Error("Syntax error, unrecognized expression: "+b);});e.push(g)}});return e},r=function(){var b=new Date;c.forEach(function(a){if(d(a.conds[0],b.getMinutes())&&d(a.conds[1],b.getHours())&&d(a.conds[3],b.getMonth()+1)){if(null!==a.conds[2]&&null!==a.conds[4]){if(!(d(a.conds[2], b.getDate())||d(a.conds[4],b.getDay())||0===b.getDay()&&d(a.conds[4],7)))return}else if(!d(a.conds[2],b.getDate())||!(d(a.conds[4],b.getDay())||0===b.getDay()&&d(a.conds[4],7)))return;setTimeout(q,0,a)}})},d=function(b,a){return null===b||b.some(function(b){return b.min<=a&&a<=b.max&&0===(a-b.min)%b.step})},q=function(b){b.func.apply(void 0,b.args)},g=function(b,a,d,c){"function"===typeof a?(c=Array.prototype.slice.call(arguments,2),d=a,a=!0):c=Array.prototype.slice.call(arguments,3);this.job={conds:p(b), func:d,args:c};a&&this.start()};g.prototype.start=function(){this.status()||(c.push(this.job),1===c.length&&(m=setInterval(r,6E4)))};g.prototype.stop=function(){this.status()&&(c.splice(c.indexOf(this.job),1),c.length||clearInterval(m))};g.prototype.status=function(){return-1!==c.indexOf(this.job)};return g})